
 
<!-- Modal-Chnage-Password -->
<div class="modal fade" id="idChangPassword" tabindex="-1" aria-labelledby="idChangPassword" aria-hidden="true" data-bs-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Change Password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
            <div class="alert alert-warning d-none" id="msg" style="text-align:center;"></div>
        <form class="needs-validate"novalidate>
        <div class="row">
           <div class="col-sm-12">
             Current Password :
             <div class="input-group mt-3">
                 <input type="password" class="form-control" id="idCurrPass" required/>
                 <div class="invalid-feedback">Please input confirm current password !</div>
             </div>
              New Password :
             <div class="input-group mt-3">
                 <input type="password" class="form-control" id="idNewPass" required />
                 <div class="invalid-feedback">Please input confirm new password !</div>
             </div>
               Confirm Password :
             <div class="input-group mt-3">
                 <input type="password" class="form-control" id="idComPass" required/>
                 <div class="invalid-feedback">Please input confirm password !</div>
             </div>
          </div> 
          <hr />
           <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">Save Change</button>
         </div>
      </div>
      </form>
    </div>
  </div>
</div>
</div>

<script type="text/javascript">

    var form = document.getElementsByClassName('needs-validate'); //ចាប់classចេញពីform
    var Validation = Array.prototype.filter.call(form, function (forms) {
        forms.addEventListener('submit', function (event) {
            if (forms.checkValidity() === false) { //ពេលមិនបានបំពេញ វាមិនអោយទៅមុខទៀតហើយលោតពណ៍ក្រហម
                event.preventDefault();
            } else {
                event.preventDefault();
                if ($('#idCurrPass').val() === $('#idComPass').val() === $('#idNewPass').val()) {
                    $('#msg').removeClass('d-none')
                    $('#msg').text("New password cannot be your old password. Please try again! ")
                    setTimeout(function () {
                        $('#msg').addClass('d-none');
                    }, 5000)
                } else if ($('#idComPass').val() != $('#idNewPass').val()) {
                    $('#msg').removeClass('d-none')
                    $('#msg').text("New password and confirmPassword incorrect. Please try again!")
                    setTimeout(function () {
                        $('#msg').addClass('d-none');
                    }, 5000)
                } else {
                    $.ajax({
                        url: '@Url.Action("ChangePassword", "Login")',
                        type: 'GET',
                        dataType: 'JSON',
                        data: { OldPass: $('#idCurrPass').val(), NewPass: $('#idNewPass').val() },
                        success: function (data) {
                            if (data.errCode == 0) {
                                $('#msg').removeClass('d-none')
                                $('#msg').removeClass('alert-warning')
                                $('#msg').addClass('alert-success')
                                /* $('#msg').text(data.errMsg)*/
                                $('#msg').text("Your password was changed successfully")
                                setTimeout(function () {
                                    $('#msg').addClass('d-none')
                                    $('#msg').addClass('alert-warning')
                                    $('#msg').removeClass('alert-success')
                                }, 5000)
                            } else {
                                $('#msg').removeClass('d-none')
                                $('#msg').text("Current Passwrod incorrect. Please try again!")
                                setTimeout(function () {
                                    $('#msg').addClass('d-none');
                                }, 5000)
                            }
                        }
                    })
                }
            }
            forms.classList.add('was-validated');
        }, false)
    });
</script>